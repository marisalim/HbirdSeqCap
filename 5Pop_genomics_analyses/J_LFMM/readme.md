#  MAF filter script descriptions

Required software:
- Python 2.7

Set up genotype files, remove low frequency alleles:

## 1. Make new directory in angsd_analysis, for selection_tests

## 2. In this folder, copy over the SNP called geno files and MAF files generated by [ANGSD](../I_ANGSD_genotype_calls/readme.md):

Species |	SNP called geno and maf file name from ANGSD_optgenocall_check
--- | ---
C. violifer |	cviol59_optP95_out
C. coruscans |	ccoru97_optP95_out

## 3. Remove SNPs with low frequencies, with minor frequency of <5%

Filtering done by these Python scripts, that are batch run on HPC with the .sh wrapper scripts:
```
ccoru_MAFfiltercode.py
cviol_MAFfiltercode.py
```

Wrapper scripts:
```
sbatch MAFwrapper_ccoru.sh
sbatch MAFwrapper_cviol.sh
```

- see slurm/log files for these numbers per species:
  - Number of sites kept (MAF >0.05)
  - Number of sites removed (MAF <0.05)
  - Total number of sites before filter
  - % sites retained

## 4. Remove HBB combined_Contig233 rows. Remove combined_Contigs that match HBE1.

(These were removed because the hemoglobin sequence was too difficult to resolve due to gene family similarities (HBB and HBE1) - I tried looking at the hemoglobin genes separately, but didn't have enough sequencing resolution to be confident about variants. Tabled that for a future analysis where we should directly Sanger sequence the hemoglobin genes).

HBE1 = these three regions:
```
>Contig11577	R010829 scaffold401_R010829_start131424_stop131746
>Contig11576	R010828 scaffold401_R010828_start127376_stop127698
>Contig11575	R010830 scaffold401_R010830_start135862_stop136184
```

```
sbatch remove_HBB_HBE1_contigs.sh
```

The output is now ready for selection tests. I tried PCadapt, OUTflank, and [LFMM](./LFMM_analyses). There were so many hits from PCadapt, it seemed to have too high a false positive rate and distribution was skewed for genetically structure populations. OUTflank's neutral Fst distributions were also skewed for genetically structured populations. So, we only used LFMM results in the final paper.
